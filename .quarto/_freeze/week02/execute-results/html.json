{
  "hash": "2b8543cc1cd1f02990c69618971d9c0c",
  "result": {
    "markdown": "---\ntitle: \"Numerical and Visual Data Summaries\"\n---\n\n\n\n\n## Recap Week 01\n\nWe looked at four things:\n\n- An example experiment (stents)\n- data basics\n- sampling\n- experiments\n\nThe best way to read the textbook is to do some of the exercises. I expect you to spend 6 to 9 hours doing so outside of class each week. This is based on the popular rule of thumb that three class hours implies six to nine study hours.\n\nLet's look at some of the Chapter 1 exercises briefly.\n\n## Textbook Section 1.1, An Example Experiment (stents)\nHere we looked at treatment groups and control groups.\n\n### Textbook Exercise 1.1, the `migraine` data set\nIn class we loaded the data set and made a contingency table, with which we can answer the four questions in Exercise 1.1.\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(digits=1)\nload(paste0(Sys.getenv(\"STATS_DATA_DIR\"),\"/migraine.rda\"))\nhead(migraine)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      group pain_free\n1 treatment       yes\n2 treatment       yes\n3 treatment       yes\n4 treatment       yes\n5 treatment       yes\n6 treatment       yes\n```\n:::\n\n```{.r .cell-code}\ntbl <- with(migraine,table(pain_free,group))\ntbl\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         group\npain_free control treatment\n      no       44        33\n      yes       2        10\n```\n:::\n:::\n\n\nThe four questions are:\n\n(a) What percent of patients in the treatment group were pain free 24 hours after receiving acupuncture?\n(b) What percent were pain free in the control group?\n(c) In which group did a higher percent of patients become pain free 24 hours after receiving acupuncture?\n(d) Your findings so far might suggest that acupuncture is an effective treatment for migraines for all people\nwho suffer from migraines. However, this is not the only possible conclusion that can be drawn based\non your findings so far. What is one other possible explanation for the observed difference between the\npercentages of patients that are pain free 24 hours after receiving acupuncture in the two groups?\n\nWe can use the `tbl` object we created to answer these questions.\n\n(a) The percentage of patients in the treatment group who were pain free was 23.3%.\n(b) The percentage of patients in the control group who were pain free was 4.3%.\n(c) A higher percent of the treatment group became pain free.\n(d) Not all migraine headaches are alike. It is possible that, due to chance, the patients in the treatment  group had less severe migraine headaches that were easier to cure.\n\nExamine the `.qmd` file that renders into this `.html` file. You'll see that, rather than specify the numbers in the answers above, we actually did the calculations inline. What is good about doing this? (Hint: what happens if you add patients to the data set and rerender the document?) What is bad about doing this? (Hint: it looks clumsy and we could just as easily run the calculations in an `r` chunk, assign the results to object, and name the objects inline.)\n\nAnother issue is the code for part c. I only accounted for the case where the treatment group has the greater percent. It would be much better to add an `else` clause to account for the possibility that the answer should be `control` and an else to account for the two to be equal. The best way to do that is to create a non-echoing chunk and use the results inline. For example, the following chunk only appears in the `.qmd` file, not the `.html` file, but its results can be used inline.\n\n\n\n\n\nNow we can say that the treatment group had the higher percentage. Only one problem remains and it is a software engineering problem. We haven't tested the above code on a case where the control group or neither group had the higher percentages. We'll leave that for now as a more advanced topic.\n\n## Textbook Section 1.2, Data Basics\nHere we looked at\n\n- observations (rows), variables (columns), and data matrices (data frames)\n- types of variables (dbl or continuous, int or discrete, fctr or nominal, and ordered fctr or ordinal)\n- relationships between variables\n- explanatory (x or features or input) and response (y or targets or output) variables\n- observational studies and experiments (and we mentioned an in-between activity called quasi-experiments)\n\nR                  Openintro Stats textbook\n------------------ --------------------------\ndbl, as.numeric()  numerical, continuous\nint, as.integer()  numerical, discrete\nfctr, factor()     categorical, nominal\nord, ordered()     categorical, ordinal\n------------------ --------------------------\n: *Data Type terminology: R vs the Textbook*\n\nOn the left of the above table, you see how R refers to data types. On the right is how the OpenIntro Stats textbook refers to data types. When you display a *tibble* (a tibble is a data frame with some extra information) using R, each variable column will be headed with `dbl`, `int`, `fctr`, or `ord` to indicate the four kinds of numbers. If a variable is not interpreted as a number, R will display `chr` as an abbreviation of character.\n\n### Textbook Exercise 1.7\nWhat were the explanatory and response variables in the migraine study? The `group` was explanatory and `pain_free` was the response variable.\n\n### Textbook Exercise 1.12\nThis is a hard question in two parts.\n\n(a) List the variables used in creating this visualization.\n(b) Indicate whether each variable in the study is numerical or categorical. If numerical, identify as contin-\nuous or discrete. If categorical, indicate if the variable is ordinal.\n\nThere is actually an `r` package underlying this question. If you visit\n[https://github.com/dgrtwo/unvotes](https://github.com/dgrtwo/unvotes)\nyou will see the data represented as a tibble. If you recall, during week one we said that a tibble is a data frame that *behaves* well. Among its features is a list of the data types, so you can answer parts a and b by looking at a tibble of the data, where you'll see that\n\n- year is stored as dbl although it is really discrete and could be stored as int\n- country is stored as chr which means *characters* although it is really a nominal factor\n- percent_yes is stored as a dbl which is appropriate\n- issue is stored as chr although it is really a nominal factor\n\nLater we'll learn how to produce a visualization like this, although you are welcome to try based on the code at the unvotes website mentioned above. If you want the actual code itself, you can slightly modify the code at\n[https://rpubs.com/minebocek/unvotes](https://rpubs.com/minebocek/unvotes) to include Mexico.\n\n## Textbook Section 1.3, Sampling\nHere we talked about random sampling, stratified sampling, cluster sampling, and observational studies.\n\n### Textbook Exercise 1.15, Asthma\n\n(a) What is the population of interest and the sample? Note that the population is NOT all asthma sufferers. The population of interest is all asthma patients aged 18-69 who rely on medication for asthma treatment. The sample consists of 600 such patients.\n(b) Is the study generalizable? Can we establish cause and effect? The patients are probably not randomly sampled, so we need to know more to say whether they represent all asthma patients 18--69 who rely on medication. For example, they could all be from a high-pollution city. We would need to know that. The cause and effect determination is easier. An experiment can determine cause and effect, while an observational study only determines association.\n\n## Textbook Section 1.4, Experiments\nHere we discussed four issues:\n\n- control\n- randomization\n- replication\n- blocking\n\n### Textbook Exercise 1.34, Exercise and mental health\nA researcher is interested in the effects of exercise on mental health\nand he proposes the following study: Use stratified random sampling to ensure representative proportions\nof 18-30, 31-40 and 41-55 year olds from the population. Next, randomly assign half the subjects from each\nage group to exercise twice a week, and instruct the rest not to exercise. Conduct a mental health exam at\nthe beginning and at the end of the study, and compare the results.\n\n(a) What type of study is this?\n(b) What are the treatment and control groups in this study?\n(c) Does this study make use of blocking? If so, what is the blocking variable?\n(d) Does this study make use of blinding?\n(e) Comment on whether or not the results of the study can be used to establish a causal relationship between exercise and mental health, and indicate whether or not the conclusions can be generalized to the population at large.\n(f) Suppose you are given the task of determining if this proposed study should get funding. Would you have any reservations about the study proposal?\n\n### Answers\n\n(a) This is an experiment.\n(b) The treatment is exercise twice a week and control is no exercise.\n(c) Yes, the blocking variable is age.\n(d) No, the study is not blinded since the patients will know whether or not they are exercising.\n(e) Since this is an experiment, we can make a causal statement. Since the sample is random, the causal statement can be generalized to the population at large. However, we should be cautious about making a causal statement because of a possible placebo effect.\n(f) It would be very difficult, if not impossible, to successfully conduct this study since randomly sampled people cannot be required to participate in a clinical trial\n\n## Textbook Chapter 2: Summarizing data\nThis week, we'll look at numerical data, categorical data, and a case study.\n\n### Numerical data\nThere are graphical and numerical methods for summarizing numerical data, including\n\n- scatterplots\n- dot plots\n- mean\n- histograms\n- variance and standard deviation\n- box plots, quartiles, and the median\n- robust statistics\n- cartographic maps and cartograms\n\nWe can draw a scatterplot of two variables of the `loan50` data as follows.\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(repos=structure(c(CRAN=\"https://cran.microsoft.com/\")))\nlibrary(tidyverse)\nload(paste0(Sys.getenv(\"STATS_DATA_DIR\"),\"/loan50.rda\"))\nloan50 |>\n  ggplot(aes(annual_income,loan_amount)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nThe above is a very basic scatterplot. Later, we'll learn to change colors, background, labels, legends, and more. Bear in mind that the scatterplot is meant to compare two numeric variables. You can't use it for a numeric variable and a categorical variable.\n\nWe can create a basic dotplot as follows.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nloan50 |>\n  ggplot(aes(homeownership)) +\n  geom_dotplot()\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nA dotplot may be helpful to illustrate a categorical variable, but I seldom use them. Using them in concert with a boxplot may make more sense. We'll look at boxplots later.\n\nThe mean is part of a good summary of data. We can find the mean of a variable by saying `mean(variable_name)` or as part of a summary. For instance\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(loan50,mean(annual_income))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 86170\n```\n:::\n\n```{.r .cell-code}\nwith(loan50,summary(annual_income))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  28800   55750   74000   86170   99500  325000 \n```\n:::\n:::\n\n\nNotice that the `summary()` function also gives us the minimum, the first quartile, the median, the 3rd quartile, and the maximum value of the variable, in addition to the mean. We'll discuss all these statistics in the context of other ways to extract them.\nThe problem with the mean that is demonstrated in the textbook is that two variables may have very different shapes but the same mean. So the textbook then describes histograms, which are a good way to identify the shape of a variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nloan50 |>\n  ggplot(aes(annual_income)) +\n  geom_histogram()\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nNotice that the *x*-axis labels are shown in scientific notation. We can fix this using the `scales` package. By the way, in case I haven't mentioned it before, we always refer to the horizontal axis as the *x*-axis and the vertical axis as the *y*-axis. This is the default for `r` and many other languages that create graphical displays.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(scales)\nloan50 |>\n  ggplot(aes(annual_income)) +\n  geom_histogram() +\n  scale_x_continuous(labels = comma_format())\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nYou may have noticed that Hadley Wickham, the inventor of the Tidyverse, dislikes the default number of bins in a histogram. So he programmed `ggplot()` to always show a warning message saying to pick a better number, depending on your data. We can fix that easily with a parameter to `geom_histogram()`. Then each bin (vertical stripe) will represent a thousand dollars.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nloan50 |>\n  ggplot(aes(annual_income)) +\n  geom_histogram(binwidth=1000) +\n  scale_x_continuous(labels = comma_format())\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nYou may notice that warning messages aren't dealbreakers. An error message on the other hand, will often stop output dead in its tracks.\n\nThe next concepts covered in the textbook are variance and standard deviation. We can calculate them as follows. When you do this, you may notice that `sd()` is the square root of `var()`. Why would you prefer one over the other? Usually you use `sd()` because it's in the same units as the data, dollars in the following case, unlike `var()`, which is in squared units, squared dollars in the following case.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(loan50,var(annual_income))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3e+09\n```\n:::\n\n```{.r .cell-code}\nwith(loan50,sd(annual_income))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 57566\n```\n:::\n:::\n\n\nTogether, the mean and standard deviation are often a good, yet compact, description of a data set.\n\nYou may want to find the means of all the columns in a data set. If you try to do that with the `colMeans()` function, you'll get an error message as follows. (Actually, I've disabled the following code chunk by saying `#| eval: false` in the `.qmd` file because otherwise the rendering would halt.)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolMeans(loan50)\n```\n:::\n\n\nThe remedy is to use a logical function to identify only the numeric columns.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolMeans(loan50[sapply(loan50, is.numeric)])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             emp_length                    term           annual_income \n                     NA                   4e+01                   9e+04 \n         debt_to_income      total_credit_limit   total_credit_utilized \n                  7e-01                   2e+05                   6e+04 \nnum_cc_carrying_balance             loan_amount           interest_rate \n                  5e+00                   2e+04                   1e+01 \n public_record_bankrupt            total_income \n                  8e-02                   1e+05 \n```\n:::\n:::\n\n\nThis is okay, but the results are in scientific notation. You can use the `format()` function to supress scientific notation as follows.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nformat(colMeans(loan50[sapply(loan50, is.numeric)]),scientific=FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             emp_length                    term           annual_income \n            \"       NA\"             \"    42.72\"             \" 86170.00\" \n         debt_to_income      total_credit_limit   total_credit_utilized \n            \"     0.72\"             \"208546.64\"             \" 61546.54\" \nnum_cc_carrying_balance             loan_amount           interest_rate \n            \"     5.06\"             \" 17083.00\"             \"    11.57\" \n public_record_bankrupt            total_income \n            \"     0.08\"             \"105220.56\" \n```\n:::\n:::\n\n\nNotice that you often wrap a function inside another function. The only problem is that it's easy to lose track of all the parentheses.\n\nThe next topic in the textbook is the box plot. This also gives an opportunity to talk about the quartiles and the median. We can display a box plot as follows.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nloan50 |>\n  ggplot(aes(annual_income)) +\n  geom_boxplot() +\n  scale_x_continuous(labels = comma_format())\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nThe thick line in the middle of the box is the median, the middle value of the data set. The box itself is bound by the first and third quartiles, known as *hinges*. The full name of this construct is actually a *box and whiskers plot* and the lines extending horizontally from the box are called whiskers. The upper whisker extends from the hinge to the largest value no further than 1.5 * IQR from the hinge (where IQR is the inter-quartile range, or distance between the first and third quartiles). The lower whisker extends from the hinge to the smallest value at most 1.5 * IQR of the hinge. Data beyond the end of the whiskers are called \"outlying\" points and are plotted individually.\n\nWe often want to create several box plots and compare them. This is easy to do as follows.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nloan50 |>\n  ggplot(aes(annual_income,homeownership)) +\n  geom_boxplot() +\n  scale_x_continuous(labels = comma_format())\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nThe textbook's next topic is *Robust Statistics* and we're going to pretty much skip that for now, except to say that outliers, as shown in the textbook, can affect the value of some statistics more than others. The mean and median are a good example. The median is much more robust to outliers than is the mean, which can be dragged way up or down by the presence of just one or a few outliers, whereas the median can not. As a kind of thought experiment, consider the following data set and the addition of an outlier and the effect of the outlier on the mean and median.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx<-c(2,3,3,3,4,4,4,5,5,6,6)\nmean(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4\n```\n:::\n\n```{.r .cell-code}\nmedian(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4\n```\n:::\n\n```{.r .cell-code}\ny<-c(2,3,3,3,4,4,4,5,5,6,6,800)\nmean(y)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 70\n```\n:::\n\n```{.r .cell-code}\nmedian(y)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4\n```\n:::\n:::\n\n\nFinally, the chapter considers maps. There is a kind of map called a choropleth map that shows the value of a numeric variable in a geographic region. An example of density of French restaurants follows. First, here's an open source map of Sagarmatha, aka Mount Everest, followed by one of London, followed by one of Austin. To get the bounding box for Austin, I used\n[https://norbertrenner.de/osm/bbox.html](https://norbertrenner.de/osm/bbox.html).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggmap)\nbbox_everest <- c(left = 86.05, bottom = 27.21, right = 87.81, top = 28.76)\nggmap(get_stamenmap(bbox_everest, zoom = 9))\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\nbbox_london<-c(-0.489,51.28,0.236,51.686)\nggmap(get_stamenmap(bbox_london))\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-17-2.png){width=672}\n:::\n\n```{.r .cell-code}\nbbox_austin <- c(-97.818,30.179,-97.604,30.336)\nggmap(get_stamenmap(bbox_austin,zoom=12))\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-17-3.png){width=672}\n:::\n:::\n\n\n<!--\n\nOnce we have a map, we can plot shapes on it. It can be quite a lengthy and time-consuming process, as this map of restaurant density in Southern France shows. This code is from the R Graph Gallery, which I consult frequently for examples of visualizations. The URL for this particular map is\n[link](https://r-graph-gallery.com/327-chloropleth-map-from-geojson-with-ggplot2.html).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#. Geospatial data available at the geojson format\nlibrary(geojsonio)\nspdf <- geojson_read(\"https://raw.githubusercontent.com/gregoiredavid/france-geojson/master/communes.geojson\",  what = \"sp\")\n\n#. Since it is a bit too much data, I select only a subset of it:\nspdf <- spdf[ substr(spdf@data$code,1,2)  %in% c(\"06\", \"83\", \"13\", \"30\", \"34\", \"11\", \"66\") , ]\n\n#. I need to fortify the data AND keep trace of the commune code! (Takes ~2 minutes)\nlibrary(broom)\nspdf_fortified <- tidy(spdf)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: `tidy.SpatialPolygonsDataFrame()` was deprecated in broom 1.0.4.\nℹ Please use functions from the sf package, namely `sf::st_as_sf()`, in favor\n  of sp tidiers.\n```\n:::\n\n```{.r .cell-code}\n#. Now I can plot this shape easily as described before:\nggplot() +\n  geom_polygon(data = spdf_fortified, aes( x = long, y = lat, group = group), fill=\"white\", color=\"grey\") +\n  theme_void() +\n  coord_map()\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#. Now I have a map of the communes of Southern France\n\n#. Next I want the number of restaurants in each commune\n#. read data\ndata <- read.table(\"https://raw.githubusercontent.com/holtzy/R-graph-gallery/master/DATA/data_on_french_states.csv\", header=T, sep=\";\")\n\n#. Distribution of the number of restaurants\ndata |>\n  ggplot( aes(x=nb_equip)) +\n    geom_histogram(bins=20, fill='skyblue', color='#69b3a2') + scale_x_log10()\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-18-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#. Now I have a histogram of the number of restaurants on a log scale\n\n#. Make the merge between the numbers of restaurants and the geography using the fact that id in one data set is the same as depcom in the other\nspdf_fortified <- spdf_fortified %>%\n  left_join(. , data, by=c(\"id\"=\"depcom\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in left_join(., data, by = c(id = \"depcom\")): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 45923 of `x` matches multiple rows in `y`.\nℹ Row 5637 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n```\n:::\n\n```{.r .cell-code}\n#. Note that if the number of restaurant is NA, it is in fact 0\nspdf_fortified$nb_equip[ is.na(spdf_fortified$nb_equip)] = 0.001\n\nlibrary(viridis)\np <- ggplot() +\n  geom_polygon(data = spdf_fortified, aes(fill = nb_equip, x = long, y = lat, group = group) , size=0, alpha=0.9) +\n  theme_void() +\n  scale_fill_viridis(trans = \"log\", breaks=c(1,5,10,20,50,100), name=\"Number of restaurant\", guide = guide_legend( keyheight = unit(3, units = \"mm\"), keywidth=unit(12, units = \"mm\"), label.position = \"bottom\", title.position = 'top', nrow=1) ) +\n  labs(\n    title = \"South of France restaurant concentration\",\n    subtitle = \"Number of restaurants per city district\",\n    caption = \"Data: INSEE | Creation: Yan Holtz | r-graph-gallery.com\"\n  ) +\n  theme(\n    text = element_text(color = \"#22211d\"),\n    plot.background = element_rect(fill = \"#f5f5f2\", color = NA),\n    panel.background = element_rect(fill = \"#f5f5f2\", color = NA),\n    legend.background = element_rect(fill = \"#f5f5f2\", color = NA),\n\n    plot.title = element_text(size= 22, hjust=0.01, color = \"#4e4d47\", margin = margin(b = -0.1, t = 0.4, l = 2, unit = \"cm\")),\n    plot.subtitle = element_text(size= 17, hjust=0.01, color = \"#4e4d47\", margin = margin(b = -0.1, t = 0.43, l = 2, unit = \"cm\")),\n    plot.caption = element_text( size=12, color = \"#4e4d47\", margin = margin(b = 0.3, r=-99, unit = \"cm\") ),\n    legend.position = c(0.7, 0.09)) +\n  coord_map()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n:::\n\n```{.r .cell-code}\np\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-18-3.png){width=672}\n:::\n:::\n\n\nBear in mind that I don't expect you to make maps this sophisticated. I just want you to know what's possible and to get a general idea of the code involved. As you read this chapter, it would be good to do a few of the exercises, just as I've shown you the exercises from Chapter 1.\n\n-->\n\n## Categorical Data\nWe've already seen contingency tables and how to manipulate them, which are introduced in more detail in this section. We've also seen a mosaic plot. Another kind of plot introduced in this section is the bar plot. We'll examine each of these.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(paste0(Sys.getenv(\"STATS_DATA_DIR\"),\"/migraine.rda\"))\ntbl <- with(migraine,table(pain_free,group))\ntbl <- addmargins(tbl)\nlibrary(kableExtra)\ntbl |>\n  kbl() |>\n  kable_classic(full_width=F) |>\n  row_spec(3, color = \"white\", background = \"#AAAAAA\") |>\n  column_spec(4, color = \"white\", background = \"#AAAAAA\") |>\n  column_spec(1, color = \"black\", background = \"white\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> control </th>\n   <th style=\"text-align:right;\"> treatment </th>\n   <th style=\"text-align:right;\"> Sum </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> no </td>\n   <td style=\"text-align:right;\"> 44 </td>\n   <td style=\"text-align:right;\"> 33 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 77 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> yes </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: white !important;background-color: #AAAAAA !important;color: black !important;background-color: white !important;\"> Sum </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 46 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 43 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;color: white !important;background-color: #AAAAAA !important;\"> 89 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nAs before, we can create a mosaic plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl <- with(migraine,table(pain_free,group))\nmosaicplot(tbl)\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\nWe can also create bar plots.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nloan50 |>\n  ggplot(aes(homeownership)) +\n    geom_bar()\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nloan50 |>\n  ggplot(aes(homeownership,fill=loan_purpose)) +\n    geom_bar() +\n    scale_fill_brewer()\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\nThe above looks better but is misleading because it implies an ordinal relationship between the loan purposes and there is no such relationship. We would be better of specifying that the `loan_purpose` variable is qualitative.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nloan50 |>\n  ggplot(aes(homeownership,fill=loan_purpose)) +\n    geom_bar() +\n    scale_fill_brewer(type=\"qual\",palette=\"Set1\")\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\nI find the above palette to be ugly but several others are available. Google *colorbrewer* for more info. By the way, these colors have been extensively psychologically tested to verify that people can easily distinguish between them. I'm uncertain about colorblind people because the most prevalent form of color blindness is red-green.\n\n## Thursday's class\n\n### Statistical summary tools\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ISLR2)\ndata(Auto)\nAuto <- na.omit(Auto)\nwith(Auto,cylinders<-as.factor(cylinders))\n```\n:::\n\n\nHere are some statistical summary questions we can answer about the `Auto` data set.\n\na. What is the range of each quantitative predictor? You can answer this using the `range()` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(Auto,range(mpg))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1]  9 47\n```\n:::\n\n```{.r .cell-code}\nwith(Auto,range(displacement))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1]  68 455\n```\n:::\n\n```{.r .cell-code}\nsapply(Auto[,c(1,3:7)],range)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     mpg displacement horsepower weight acceleration year\n[1,]   9           68         46   1613            8   70\n[2,]  47          455        230   5140           25   82\n```\n:::\n\n```{.r .cell-code}\nsapply(Auto[,sapply(Auto,is.numeric)],range)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     mpg cylinders displacement horsepower weight acceleration year origin\n[1,]   9         3           68         46   1613            8   70      1\n[2,]  47         8          455        230   5140           25   82      3\n```\n:::\n:::\n\n\n(b) What is the mean and standard deviation of each quantitative predictor?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsapply(Auto[,c(1,3:7)],mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         mpg displacement   horsepower       weight acceleration         year \n          23          194          104         2978           16           76 \n```\n:::\n\n```{.r .cell-code}\nsapply(Auto[,c(1,3:7)],sd)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         mpg displacement   horsepower       weight acceleration         year \n           8          105           38          849            3            4 \n```\n:::\n\n```{.r .cell-code}\nas.data.frame(t(sapply(Auto[,c(1,3:7)],function(bla) list(means=mean(bla),sds=sd(bla),ranges=range(bla)))))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             means sds     ranges\nmpg             23   8      9, 47\ndisplacement   194 105    68, 455\nhorsepower     104  38    46, 230\nweight        2978 849 1613, 5140\nacceleration    16   3      8, 25\nyear            76   4     70, 82\n```\n:::\n:::\n\n\n(c) Now remove the 10th through 85th observations. What is the range, mean, and standard deviation of each predictor in the subset of the data that remains?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nas.data.frame(t(sapply(Auto[-10:-85,c(1,3:7)],function(bla) list(means=mean(bla),sds=sd(bla),ranges=range(bla)))))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             means sds     ranges\nmpg             24   8     11, 47\ndisplacement   187 100    68, 455\nhorsepower     101  36    46, 230\nweight        2936 811 1649, 4997\nacceleration    16   3      8, 25\nyear            77   3     70, 82\n```\n:::\n:::\n\n\n### Exercises\n\nCreate a Quarto document called `week02exercises.qmd`. Use your name as the author name and the date as the current date. Make the title within the document \"Week 2 Exercises\".\n\nAnswer the following questions in the document, using a combination of narration and R chunks.\n\n1. Use the `loan50` data set. Find the mean and median of `annual_income` using R. Tell why they differ in words.\n\n2. Use the `loan50` data set. Make a contingency table of `loan_purpose` and `grade`. Tell the most frequently occurring grade and most frequently occurring loan purpose in words.\n\n3. Use the `loan50` data set. Provide a statistical summary of `total_credit_limit`.\n\n4. Use the `loan50` data set. Show the column means for all numeric columns.\n\n5. Use the `loan50` data set. Make a contingency table of `state` and `homeownership`. Tell which state has the most mortgages in words.\n\nNow render the document and submit both the `.qmd` file and the `.html` file to Canvas under \"week02exercises\".\n\n### Solutions to exercises\n\n<!-- -->\n\n1. Use the `loan50` data set. Find the mean and median of `annual_income` using R. Tell why they differ in words.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(paste0(Sys.getenv(\"STATS_DATA_DIR\"),\"/loan50.rda\"))\nwith(loan50,mean(annual_income))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 86170\n```\n:::\n\n```{.r .cell-code}\nwith(loan50,median(annual_income))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 74000\n```\n:::\n:::\n\n\nThey differ because the mean is susceptible to outliers. There are about four outliers in this data set (high annual incomes) and they drag the mean upward but not the median. The median is a more reliable measure of centrality when there are influential outliers.\n\n2. Use the `loan50` data set. Make a contingency table of `loan_purpose` and `grade`. Tell the most frequently occurring grade and most frequently occurring loan purpose in words.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(loan50,addmargins(table(loan_purpose,grade)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                    grade\nloan_purpose             A  B  C  D  E  F  G Sum\n                      0  0  0  0  0  0  0  0   0\n  car                 0  0  1  1  0  0  0  0   2\n  credit_card         0  6  4  1  1  1  0  0  13\n  debt_consolidation  0  2  9  4  7  1  0  0  23\n  home_improvement    0  1  4  0  0  0  0  0   5\n  house               0  0  1  0  0  0  0  0   1\n  major_purchase      0  0  0  0  0  0  0  0   0\n  medical             0  0  0  0  0  0  0  0   0\n  moving              0  0  0  0  0  0  0  0   0\n  other               0  4  0  0  0  0  0  0   4\n  renewable_energy    0  1  0  0  0  0  0  0   1\n  small_business      0  1  0  0  0  0  0  0   1\n  vacation            0  0  0  0  0  0  0  0   0\n  wedding             0  0  0  0  0  0  0  0   0\n  Sum                 0 15 19  6  8  2  0  0  50\n```\n:::\n:::\n\n\nThe most frequently occurring purpose is debt consolidation, while the most frequently occurring grade is B.\n\n3. Use the `loan50` data set. Provide a statistical summary of `total_credit_limit`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(loan50,summary(total_credit_limit))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  15980   70526  147364  208547  299766  793009 \n```\n:::\n\n```{.r .cell-code}\nwith(loan50,scales::comma_format(summary(total_credit_limit)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nfunction (x) \n{\n    number(x, accuracy = accuracy, scale = scale, prefix = prefix, \n        suffix = suffix, big.mark = big.mark, decimal.mark = decimal.mark, \n        style_positive = style_positive, style_negative = style_negative, \n        scale_cut = scale_cut, trim = trim, ...)\n}\n<bytecode: 0x7fb786478f10>\n<environment: 0x7fb779115b40>\n```\n:::\n\n```{.r .cell-code}\n#. same info with commas in numbers\nloan50 |>\n    summarise(Min=comma(min(total_credit_limit)),\n              firstq=comma(quantile(total_credit_limit,0.25)),\n              Median=comma(median(total_credit_limit)),\n              Mean=comma(mean(total_credit_limit)),\n              thirdq=comma(quantile(total_credit_limit,0.75)),\n              Max=comma(max(total_credit_limit)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Min firstq  Median    Mean  thirdq     Max\n1 15,980 70,526 147,364 208,547 299,766 793,009\n```\n:::\n:::\n\n\n4. Use the `loan50` data set. Show the column means for all numeric columns.\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(digits=1)\nformat(colMeans(loan50[sapply(loan50, is.numeric)]),scientific=FALSE,big.mark=\",\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             emp_length                    term           annual_income \n           \"        NA\"            \"     42.72\"            \" 86,170.00\" \n         debt_to_income      total_credit_limit   total_credit_utilized \n           \"      0.72\"            \"208,546.64\"            \" 61,546.54\" \nnum_cc_carrying_balance             loan_amount           interest_rate \n           \"      5.06\"            \" 17,083.00\"            \"     11.57\" \n public_record_bankrupt            total_income \n           \"      0.08\"            \"105,220.56\" \n```\n:::\n:::\n\n\n5. Use the `loan50` data set. Make a contingency table of `state` and `homeownership`. Tell which state has the most mortgages in words.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(loan50,table(state,homeownership))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     homeownership\nstate rent mortgage own\n         0        0   0\n   AK    0        0   0\n   AL    0        0   0\n   AR    0        0   0\n   AZ    0        0   1\n   CA    7        2   0\n   CO    0        0   0\n   CT    1        0   0\n   DC    0        0   0\n   DE    0        0   0\n   FL    1        2   0\n   GA    0        0   0\n   HI    1        1   0\n   ID    0        0   0\n   IL    3        0   1\n   IN    0        1   1\n   KS    0        0   0\n   KY    0        0   0\n   LA    0        0   0\n   MA    1        1   0\n   MD    2        1   0\n   ME    0        0   0\n   MI    0        1   0\n   MN    0        1   0\n   MO    0        1   0\n   MS    0        1   0\n   MT    0        0   0\n   NC    0        0   0\n   ND    0        0   0\n   NE    0        1   0\n   NH    1        0   0\n   NJ    2        1   0\n   NM    0        0   0\n   NV    0        2   0\n   NY    1        0   0\n   OH    0        1   0\n   OK    0        0   0\n   OR    0        0   0\n   PA    0        0   0\n   RI    0        1   0\n   SC    0        1   0\n   SD    0        0   0\n   TN    0        0   0\n   TX    0        5   0\n   UT    0        0   0\n   VA    1        0   0\n   VT    0        0   0\n   WA    0        0   0\n   WI    0        1   0\n   WV    0        1   0\n   WY    0        0   0\n```\n:::\n:::\n\n\nTexas has five mortgages, more than any other state.\n\n### Exercise Notes\n\n1. Many students did not follow instructions on file naming. I will take off a lot of points if this happens when you turn in a graded assignment. I expect all files to be uniformly named.\n2. Several students left the boilerplate verbiage in their `.qmd` file. I will take off a lot of points if this happens when you turn in a graded assignment.\n3. One student put their narrative inside the code chunks as R comments. Don't do this. It undercuts the purpose of mixing narrative and code in a Quarto document.\n4. Some students didn't try to answer the second part of question 1. One way to understand this is to draw a boxplot of the data, showing that there are four outliers at the top end, dragging the mean upward but leaving the median pretty much alone.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nloan50 |> ggplot(aes(annual_income)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](week02_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n\n5. Some students included graphics, which don't show up in the copy on Canvas. One way to make these graphics show up is to add the following code to the front matter (the front matter is the stuff between two sets of three dashes at the beginning of the file):\n\n```\nformat:\n  html:\n    embed-resources: true\n```\n\nThe indentation shown above is essential for it to work.\n\n6. Some students highlighted relevant rows and columns as shown below. This was a really great addition.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl <- with(loan50,table(loan_purpose,grade))\ntbl <- addmargins(tbl)\nlibrary(kableExtra)\ntbl |>\n  kbl() |>\n  kable_classic(full_width=F) |>\n  row_spec(4, color = \"white\", background = \"#AAAAAA\") |>\n  column_spec(4, color = \"white\", background = \"#AAAAAA\") |>\n  column_spec(1, color = \"black\", background = \"white\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\">  </th>\n   <th style=\"text-align:right;\"> A </th>\n   <th style=\"text-align:right;\"> B </th>\n   <th style=\"text-align:right;\"> C </th>\n   <th style=\"text-align:right;\"> D </th>\n   <th style=\"text-align:right;\"> E </th>\n   <th style=\"text-align:right;\"> F </th>\n   <th style=\"text-align:right;\"> G </th>\n   <th style=\"text-align:right;\"> Sum </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\">  </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> car </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> credit_card </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: white !important;background-color: #AAAAAA !important;color: black !important;background-color: white !important;\"> debt_consolidation </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 2 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;color: white !important;background-color: #AAAAAA !important;\"> 9 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 4 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 7 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 1 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 23 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> home_improvement </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 4 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> house </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> major_purchase </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> medical </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> moving </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> other </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> renewable_energy </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> small_business </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> vacation </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> wedding </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> Sum </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 19 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 50 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nAnother way to do this is to say\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmaxrow<-max(tbl[1:length(levels(loan50$loan_purpose))-1,\"Sum\"])\nmaxcol<-max(tbl[\"Sum\",1:length(levels(loan50$grade))-1])\n```\n:::\n\n\nand\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmaxrownum <- which.max(tbl[1:length(levels(loan50$loan_purpose))-1,\"Sum\"])\nmaxcolnum <- which.max(tbl[\"Sum\",1:length(levels(loan50$grade))-1])+1\n```\n:::\n\n\nNow you can plug `maxrownum` and `maxcolnum` into the formula without having to know which row and column you're talking about.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl |>\n  kbl() |>\n  kable_classic(full_width=F) |>\n  row_spec(maxrownum, color = \"white\", background = \"#AAAAAA\") |>\n  column_spec(maxcolnum, color = \"white\", background = \"#AAAAAA\") |>\n  column_spec(1, color = \"black\", background = \"white\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\">  </th>\n   <th style=\"text-align:right;\"> A </th>\n   <th style=\"text-align:right;\"> B </th>\n   <th style=\"text-align:right;\"> C </th>\n   <th style=\"text-align:right;\"> D </th>\n   <th style=\"text-align:right;\"> E </th>\n   <th style=\"text-align:right;\"> F </th>\n   <th style=\"text-align:right;\"> G </th>\n   <th style=\"text-align:right;\"> Sum </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\">  </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> car </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> credit_card </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: white !important;background-color: #AAAAAA !important;color: black !important;background-color: white !important;\"> debt_consolidation </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 2 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;color: white !important;background-color: #AAAAAA !important;\"> 9 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 4 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 7 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 1 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 23 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> home_improvement </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 4 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> house </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> major_purchase </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> medical </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> moving </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> other </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> renewable_energy </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> small_business </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> vacation </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> wedding </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> Sum </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;color: white !important;background-color: #AAAAAA !important;\"> 19 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 50 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nAnd, in the narrative you can say that the maximum frequency of loan_purpose is 23.\nIn the narrative you can alo say that the maximum frequency of grade is 19.\n\n7. One student stipulated that the mean and median could not ever be the same except in two unusual circumstances. Actually it is quite easy for the mean to equal the mean as you can see from this simple example.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- c(1,2,3,4,5,6,7,8,9)\nmean(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5\n```\n:::\n\n```{.r .cell-code}\nmedian(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5\n```\n:::\n:::\n",
    "supporting": [
      "week02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}